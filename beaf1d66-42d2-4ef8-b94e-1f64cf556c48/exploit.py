from pwn import *

p = process("./legacyopt")

FLAG_LENGTH = 39

flag = ["A"] * FLAG_LENGTH

output = (
    "220c6a33204455fb390074013c4156d704316528205156d70b217c14255b6ce10837651234464e"
)

for i in range(FLAG_LENGTH):
    for j in string.printable:
        flag[i] = j
        p = process("./legacyopt")
        p.sendline(bytes("".join(flag), "ascii"))
        res = p.recvall(0.1).decode()
        if output[: (i + 1) * 2] == res[: (i + 1) * 2]:
            print(flag[i])
            break

print("".join(flag))
